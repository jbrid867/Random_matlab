function dy = system_new(t,y)

N=25; % max filament length

% Rates
k=zeros(16,1);

k(1)=1;
k(2)=0.1;
k(3)=100;
k(4)=1;
k(5)=.001;
k(6)=1000;
k(7)=1;
k(8)=100;
k(9)=0.1;
k(10)=100;
k(11)=.1;
k(12)=10;
k(13)=1;
k(14)=100;
k(15)=1;
k(16)=1;
k(17)=10;

% k(1)=number;

% array value;


% sums
u=zeros(23);
u(1)=k(2)*y(10);
u(2)=k(2)*y(11);
u(3)=k(6)*y(3);
u(4)=k(7)*y(6);
u(5)=k(1)*y(1)*y(1);
for i=11:N+7
    u(6)=u(6)+y(i);
end
u(6)=k(1)*u(6);
u(7)=k(5)*y(1)*y(1)*y(1);
u(8)=k(8)*y(1)*y(8);
u(9)=k(9)*y(2);
u(10)=k(11)*y(5);
u(11)=k(10)*y(3)*y(8);
u(12)=k(13)*y(7);
u(13)=k(15)*y(4);
for i=12:N+8
    u(14)=u(14)+y(i);
end
u(14)=u(14)*k(2);
u(15)=k(14)*y(2)*y(8);
u(16)=k(12)*y(2)*y(9);
u(17)=k(17)*y(4);
u(18)=k(16)*y(5);
for i=11:N+7
    u(19)=u(19)+y(i);
end
u(19)=u(19)*k(3)*y(6);
for i=12:N+8
    u(20)=u(20)+y(i);
end
u(20)=u(20)*k(4)*y(9);
u(21)=k(1)*y(10)*y(1);
u(22)=k(1)*y(11)*y(1);
u(23)=k(3)*y(11)*y(6);


% system
dy=zeros(N+8,1);
dy(1)=2*u(1)+u(2)+u(3)+u(4)-2*u(5)-u(6)-3*u(7)-u(8);
dy(2)=u(12)+u(13)+u(14)-u(9)-u(15)-u(16);
dy(3)=u(9)+u(10)-u(11)-u(3);
dy(4)=u(15)-u(13)-u(17);
dy(5)=u(17)+u(11)-u(10)-u(18);
dy(6)=u(8)+u(18)-u(4)-u(19);
dy(7)=u(20)+u(14)+u(16)-u(12);
dy(8)=u(19)+u(4)+u(10)+u(13)-u(8)-u(11)-u(15);
dy(9)=u(12)-u(20)-u(16);
dy(10)=u(5)-u(1)-u(21);
dy(11)=u(21)+u(7)-u(2)-u(22)-u(23);
for i=12:N+7
    dy(i)=k(1)*y(i-1)*y(1)+k(3)*y(i-1)*y(6)-k(2)*y(i)-k(4)*y(i)*y(9)-k(1)*y(i)*y(1)-k(3)*y(i)*y(6);
end
dy(N+8)=k(1)*y(N+7)*y(1)+k(3)*y(N+7)-k(2)*y(N+8)-k(4)*y(N+8)*y(9);

